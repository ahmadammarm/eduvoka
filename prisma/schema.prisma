// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
    provider = "prisma-client"
    output   = "../generated/prisma"
}

datasource db {
    provider = "mysql"
}

enum Role {
    USER
    ADMIN
}

enum GayaBelajar {
    VISUAL
    AUDITORY
    KINESTHETIC
}

enum TipeSoal {
    TPS
    LITERASI
}

enum PaketUser {
    BASIC
    LITE
    ACTIVE
    EDUVOKA
}

model User {
    id           String       @id @default(uuid())
    email        String       @unique
    name         String
    password     String?
    profileImage String?
    role         Role         @default(USER)
    gayaBelajar  GayaBelajar?
    paketUser    PaketUser    @default(BASIC)
    createdAt    DateTime     @default(now())
    updatedAt    DateTime     @updatedAt

    accounts Account[]
    sessions Session[]

    jawabanUserKuisVAKs JawabanUserKuisVAK[]
}

model Account {
    id                String  @id @default(uuid())
    userId            String
    type              String
    provider          String
    providerAccountId String
    refresh_token     String? @db.Text
    access_token      String? @db.Text
    expires_at        Int?
    token_type        String?
    scope             String?
    id_token          String? @db.Text
    session_state     String?

    user User @relation(fields: [userId], references: [id], onDelete: Cascade)

    @@unique([provider, providerAccountId])
}

model Session {
    id           String   @id @default(uuid())
    sessionToken String   @unique
    userId       String
    expires      DateTime

    user User @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model PertanyaanKuisVAK {
    id         String   @id @default(uuid())
    pertanyaan String   @db.Text
    createdAt  DateTime @default(now())
    updatedAt  DateTime @updatedAt

    jawabanKuisVAKs JawabanKuisVAK[]

    jawabanUserKuisVAKs JawabanUserKuisVAK[]
}

model JawabanKuisVAK {
    id String @id @default(uuid())

    kuisVAKId   String
    jawaban     String
    tipeJawaban GayaBelajar
    createdAt   DateTime    @default(now())
    updatedAt   DateTime    @updatedAt

    kuisVAK             PertanyaanKuisVAK    @relation(fields: [kuisVAKId], references: [id], onDelete: Cascade)
    jawabanUserKuisVAKs JawabanUserKuisVAK[]
}

model JawabanUserKuisVAK {
    id                  String @id @default(uuid())
    userId              String
    pertanyaanKuisVAKId String
    jawabanKuisVAKId    String

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    user              User              @relation(fields: [userId], references: [id], onDelete: Cascade)
    pertanyaanKuisVAK PertanyaanKuisVAK @relation(fields: [pertanyaanKuisVAKId], references: [id], onDelete: Cascade)
    jawabanKuisVAK    JawabanKuisVAK    @relation(fields: [jawabanKuisVAKId], references: [id], onDelete: Cascade)

    @@unique([userId, pertanyaanKuisVAKId])
}

model SoalUTBK {
    id           String   @id @default(uuid())
    tipe         TipeSoal
    content      String   @db.Text
    kunciJawaban String

    pilihanJawaban PilihanJawaban[]
}

model PilihanJawaban {
    id         String @id @default(uuid())
    soalUTBKId String
    pilihan    String

    soalUTBK SoalUTBK @relation(fields: [soalUTBKId], references: [id], onDelete: Cascade)
}
